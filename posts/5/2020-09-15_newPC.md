---
title: '自作PCを新しく換装＆いろいろ設定'
date: '2020-09-15'
---

気づいたら9月も半ばです…。たぶん生きてます。

8月の下旬あたりにPCをリニューアルし、現在快適に稼動しています。全てを丸ごと変えているわけではなく、ハード部分を交換というエコ？な形です。

以前のPCはローエンドで約10年ものに近い状態だったので、そろそろこのメモリ速度と容量では現代を耐えきれないと思ったためです。
最近になって表示速度や処理速度が重くなってきたと感じており、原因としてメモリ不足によるページファイルの増加やそもそものメモリ速度の遅さを疑っていました。

## リニューアルしたPCスペック

- CPU: AMD Ryzen5 3500
- メモリ: G.Skill F4-3600C18D-16GTZN
- マザー: ASUS TUF GAMING B550-PLUS
- GPU: ASUS DUAL-GTX1660S-O6G-MINI
- 電源: NZXT C750

以下は継続利用

- HDD: WD Blue 1TB (WD10EZEX)
- HDD: Hitachi 500GB
- ケース: Fractal Design Meshify C - Dark Tempered Glass

CPUクーラーはコスト削減でリテールを利用。
そこでグリスはリテールについているものよりかはと思い、MX-4にしました。

## 取り付けに罠のある Wraith STEALTH クーラー

Wraith クーラーの形とマザボにはじめから付いているバックプレート固定のフロント部の形状を比較した時に、どう見てもマザボ側のフロント部は取り除く必要がありそうでした。
グリスを付ける前にクーラーをあわせてみたところ、バックプレートの固定ネジ穴とクーラーのネジの位置は一致していました。
つまり、クーラーとバックプレートを直接ネジ止めするタイプだったのです！

この場合バックプレートの支えが無いので、クーラーを取り付ける際に、バックプレートをテープ等で固定しないとバックプレートは落ちます。
いざ、取り付けようとしたらやはり少し下がる。。。結局後ろから手で押さえながらネジを上手く回す必要がありました。テープで仮止めしないと穴がどこにあるかわからず、マザーの裏面を傷つける可能性があったので、仮止めしておいたのは正解です。

**さらに向きも大事です！**　AMDロゴがついている部分が出っ張りになっていました。クーラー合わせる前から、メモリの部分と衝突しそうだったので、ロゴの位置は左が絶対です。
逆にしてしまうとおそらく2つのメモリが差せなくなるという事態に陥ります。注意しましょう。
なぜ出っ張りが上になるように設計していないのか謎です…。

まさか、Wraith STEALTH クーラーは取り付けが難しいとは思っていませんでした。
AMDのリテールであるWraithシリーズを見てみると、STEALTH と同型の SPIRE も同じタイプでした。
しかしながら上位CPUモデルに付属する MAX と PRISM はヒートシンクが四角く、フックのようなものとレバーがあります。これは STEALTH, SPIRE では外す必要のある、マザボに初めからついていたフロント部のツメに引っ掛けてレバーを下ろすだけで取り付けが完了するタイプだと思われます。すごく簡単ですね。四角いので変な出っ張りも無いですし。

AMD CPUで STEALTH と SPIRE のリテールクーラーを利用する場合はみなさんも気をつけましょう。

## NZXT 電源付属ケーブルのちょっとした問題

ケーブルを接続していると熱収縮チューブの部分が異様に長いことに気づく。
普通のケーブルはこの半分くらいだと思うのですが、なぜかかなり長い。
このチューブ部はまず**曲がらない**ので、かなり取り回しが悪くなっています。
買う前にそういうレビューは知っていましたが、ここまでとは思っていませんでした。
なぜこのような仕様にしてしまったのか、NZXTケース向けの製品なのだろうか？と思いました。

実際に動かした時はファンの音も気にならず、他は非常に綺麗なので付属ケーブルだけなんとかなれば本当に良い電源です。

## いざ電源ON

換装してから初めての電源ONは不安になりますね。初めはBIOSが新しいハードウェアの情報を読み取るためかちょっと起動まで遅いですが、しばらくして無事にBIOSが起動。

ところがブートディスクが見つからず、OSが起動できない！

なんとかならないかと調査しました。

## レガシーブートを有効にする必要があった

OSは Windows8 のときに新しく入れていたはずですが、ファイルパーティションがGPT(GUID Partition Table)ではなくMBR(Master Boot Record)でした。MBRではレガシーなBIOSブートに対応し、GPTではUEFIブートに対応します。BIOSデフォルトはUEFIでのブートのため、レガシーブートはできないようでした。

そこで従来のBIOSブートモードをサポートするCSM(Compatibility Supported Module)という機能を有効にする必要がありました。ただ注意するのは、同時にセキュアブートを無効にしておきます。レガシーデバイスの起動がセキュアブートで引っかかるらしいです。逆にセキュアブートを有効にする場合はCSMは無効にしておくほうが良いそう。

<img src="/post-img/5/200915102608.png" alt="csm" title="csm setting">

これによってブートデバイスがちゃんと認識されました。ブートデバイス選択後、無事にWindowsが起動しました。

PCのリニューアル完了です！

以前よりもかなり動作も快適で、起動時間も速くなりました。

## ディスクのパーティションをMBRからGPTに変更する

MBRでのレガシーブートはおそらく今後は利用できなくなっていくので、この際にディスクをGPTに変更しようと思いました。
通常は空のディスクで初めから設定したいパーティションにするのがベストですが、調べたところデータを保持したままGPTへの変換が可能でした。

[MBR2GPT - Windows Deployment | Microsoft Docs](https://docs.microsoft.com/ja-jp/windows/deployment/mbr-to-gpt)

Windows10 Version 1703 以降であれば、MBR2GPTという実行ファイルがあります。

前提のひとつとしてまず起動できるOSエントリが入っているディスクでないと変換できません。

ドキュメントにあるように、前提条件の検証をして成功したので。変換を実行し、無事にGPTにできました。

<img src="/post-img/5/diskna.png" alt="disk partition" title="disk partition">

この移行作業で「システムで予約済み」のドライブ文字付きパーティションが生まれますが、変換処理後はそのドライブ文字に依存するものはないです。ディスクの管理からドライブ文字を削除すればエクスプローラーからは表示されなくなります。

## メモリのオーバークロック

せっかくDRAM 3600Mhz（FLCK 1800Mhz）可のメモリを買ったのにSPD運用なんてもったいないです。ちゃんとオーバークロックしましょう。

ASUS の BIOS であれば `Ai Overclock Tuner` から `D.O.C.P.` を選ぶだけでした。

<img src="/post-img/5/200915102321.png" alt="docp" title="docp setting">

プロファイル？みたいなものはメモリから自動検出されているようで、1つしかないのでそれを選択します。メモリに記載されていた通りのレイテンシになるようです。これでちゃんと動作しました。

また、D.O.C.P.を設定するとメモリ電圧もプロファイルの通りに1.35Vになっていました。1.4Vを越えなければ温度はそこまで上がらないらしいです。
ここからさらに速度のために無理に定格より周波数をあげるための電圧やレイテンシを調整することはせず、今のままで十分でしょう。

数値を上げる方向の調整はパーツ故障のリスクがあります。

CPUのオーバークロックでも製品に最大OC周波数が書かれています（Ryzen3500 は4.1Ghz）。
それ以上に設定する場合は故障のリスクがあるということです。

## CPUのクロック固定と低電圧化

さて、Ryzen のCPUクロックは特に設定しなければBIOSで自動になっていると思います。ただどうも負荷が掛かっていないにもかかわらず3.6Ghzから4.0GHzとかを行ったり来たりしていて、電圧も1.4V程度でした。これかなり効率が悪いようです。
Cinebenchで負荷をかけたところ、温度は69～71℃程度まで達します。

ということでクロック固定と低電圧化をしてみます。
事前調査からRyzen3500は 4.0Ghz, 1.2Vあたりがギリギリそうだったので、1.3Vあたりからテスト。

周波数の変更は ASUS BIOS であれば `CPU Core Ratio` から行います。ベースクロック(BCLK)からの倍率です。BCLKは基本的に100MHzなので、40を入力すると4.0Ghzとなります。
またCPUコア電圧の選択肢は`自動` の他に `手動` と `offset mode` があります。手動では直接数値を入力します。offsetでは基準電圧からの差を入力します。

<img src="/post-img/5/200915102406.png" alt="cpu core voltage" title="cpu setting">

3.9GHz(Ratio x39)で1.2Vまで下げてCinebenchを完了できました。この時のスコアは自動OCより少し良い程度、そのうえ温度は65～67℃程度まで押さえられました。実際にHWiNFOでCPUのPackage Powerをみると電力も押さえられています。
4.0Ghzでは1.2Vだと、Cinebenchがエラーでそもそも初められません。しばらくするとブルースクリーンが起きました。
ということで電圧を1.25Vにしてみます。するとCinebenchは無事に完了できました。
このときのスコアは自動OC時を越えました。しかも、温度は66～68℃程度です。

もうひとついえば、アイドル時の電力は周波数を行ったり来たりしていた自動OC時より5～7Wほど低くなり、アイドル時に無駄な電力を使用せずに済んでいます。

結果的に消費電力と性能のいいとこ取りができそうな4.0GHz, 1.25Vの設定で運用を決めました。
以下はCinebenchと3DMarkの結果です。自動OC時より4.0GHz固定のほうがスコアが伸びています。

<img src="/post-img/5/CinebenchScore.png" alt="Cinebench Score" title="Cinebench Score (R20)">

<img src="/post-img/5/3DMarkScore.png" alt="3DMark Score" title="3DMark Score">

## ASUS DUAL-GTX1660S-O6G-MINI は静音性抜群

最後にグラボが非常に驚きです。負荷が掛からないときはファンは自動的に止まるようになっていました。ファンが回ったとしてもとても静かです。もはやケースファンの回転音より静かなのではというくらい。温度はアイドルで50℃前後、負荷をかけても70℃前後です。
Axial-techファン搭載のモデルは基本このタイプなのでしょう。MINIシリーズは形状も好みなので選んで良かったグラボです。

GPU Tweak等は使わずにそのままでも十分に良く動いてくれます。

## 今後の展望

今回はメインドライブHDDを以前からそのまま利用してるのですが。意外にもHDDのディスク速度がハードウェアの速度にそろそろついていけなくなってきた時代がもう来ていると実感しています。
データ保管用としてはまだ安さに容量と堅牢さがありますが、運用としてはもうSSDじゃないとこれからはハードウェアの性能をフルに発揮できない可能性もあるかもしれないです。
今使っていても読み取り速度のボトルネックがHDDになっているような感覚があります。
確かに起動速度は以前のPCの半分程になりましたが、おそらくSSDだともっと早いんだろうなと。

次に追加するのはNVMe M.2タイプのSSDになりそうです。

<img src="/post-img/5/pcsmall.jpg" alt="pc" title="pc">
